<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>🎀 Get Da Link Bestie</title>
  <style>
    :root{
      --pink:#ffd3ec; --hot:#ff3fa1; --white:#fff;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family:"Comic Sans MS", "Poppins", cursive, sans-serif;}
    body{
      background: linear-gradient(135deg,#ffe4f1,#ffd3ec);
      display:block; overflow:hidden; color:var(--hot);
      text-align:center; padding:28px;
    }

    h1{font-size:clamp(1.6rem,3vw,2.4rem); margin:10px 0 18px; color:var(--hot)}
    #clickMe{
      position:absolute; left:calc(50% - 80px); top:40%;
      padding:14px 26px; background:linear-gradient(90deg,#ff8ed6,#ff69b4);
      color:white; border:0; border-radius:28px; font-size:1.15rem; cursor:pointer;
      box-shadow:0 8px 30px rgba(255,63,161,.18);
    }
    #nameSection{ display:none; margin-top:12vh; }
    .controlRow{ margin:10px 0; }
    input[type="text"]{
      padding:10px 14px; border-radius:12px; border:2px solid rgba(255,63,161,.2);
      width:260px; font-size:1rem; outline:none; background:rgba(255,255,255,.9);
    }
    .btn{ padding:10px 16px; border-radius:12px; border:0; background:var(--hot); color:white; cursor:pointer; }
    #progressWrap{ width:320px; height:14px; background:#fff; border:2px solid rgba(255,63,161,.18); border-radius:12px; margin:14px auto; overflow:hidden;}
    #progressBar{ height:100%; width:0%; background:linear-gradient(90deg,#ff69b4,#ff3fa1); transition:width .25s ease; }
    #giftBox{ display:none; margin:28px auto; padding:18px; background:#fff; border:3px dashed rgba(255,63,161,.35); border-radius:18px; width:min(720px,92%); color:#d32b6a; }
    #giftBox a{ color:var(--hot); font-weight:800; text-decoration:none; }
    .photo{ position:absolute; width:140px; height:140px; object-fit:cover; border-radius:16px; border:3px solid rgba(255,63,161,.6); box-shadow:0 18px 40px rgba(255,63,161,.12); display:none; }
    .emoji{ position:fixed; font-size:1.8rem; pointer-events:none; user-select:none; filter:drop-shadow(0 4px 12px rgba(0,0,0,.12)); }
    #overlay{
      position:fixed; inset:0; background:linear-gradient(180deg, rgba(255,228,241,.98), rgba(255,211,236,.98));
      display:none; align-items:center; justify-content:center; z-index:9999; flex-direction:column;
    }
    #loadingText{ font-size:2rem; color:var(--hot); border-right:3px solid var(--hot); padding:8px 14px; white-space:nowrap; overflow:hidden; }
    .overlayEmoji{ position:absolute; font-size:2rem; opacity:.95; animation:floatUp 3s linear forwards; }
    @keyframes floatUp { from{ transform:translateY(20vh) scale(.9);} to{ transform:translateY(-10vh) scale(1.05); opacity:0;} }
    #preOverlay{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:9998; flex-direction:column; background: rgba(255,228,241,.95); }
    #preText{ font-size:2rem; color:var(--hot); margin-bottom:20px; z-index:10001; }
    .sparkleBtn{ position:absolute; cursor:pointer; font-size:2rem; user-select:none; z-index:10000; }

    /* Rotating banner */
    #banner{
      position:fixed; top:0; left:0; width:100%; background:#ffb6d9;
      color:#fff; font-weight:700; padding:6px 0; z-index:2000;
      overflow:hidden; white-space:nowrap;
    }
    #banner span{
      display:inline-block; padding-left:100%; animation:scrollBanner 12s linear infinite;
    }
    @keyframes scrollBanner{
      from{ transform:translateX(0);}
      to{ transform:translateX(-100%);}
    }

    /* Rainbow flash */
    .rainbowFlash{
      animation:flashRainbow 1s linear 1;
    }
    @keyframes flashRainbow{
      0%{ background: red;}
      20%{ background: orange;}
      40%{ background: yellow;}
      60%{ background: green;}
      80%{ background: blue;}
      100%{ background: violet;}
    }

    /* Jumpscare */
    #jumpscare{
      position:fixed; inset:0; background:#000;
      display:none; align-items:center; justify-content:center; z-index:10000;
    }
    #jumpscare img{ max-width:80%; max-height:80%; border-radius:12px; }
    @media (max-width:520px){
      #clickMe{ left:calc(50% - 70px); }
      #progressWrap{ width:86%; }
    }
  </style>
</head>
<body>
  <div id="banner"><span>💅✨ Gimme respect, I gave u the linkkk 🎀😋✨💓😝</span></div>

  <h1>🎀 You want the link, huh? Get it</h1>
  <button id="clickMe">Click Me 🤭</button>
  <div id="nameSection">
    <div class="controlRow">
      <input id="nameField" type="text" placeholder="Type the name..." autocomplete="off" />
      <button id="submitName" class="btn">ENTER</button>
    </div>
    <div id="progressWrap">
      <div id="progressBar"></div>
    </div>
    <div style="margin-top:6px; color:#b03578; font-weight:600;" id="progressText">0 / 30</div>
  </div>
  <div id="preOverlay">
    <div id="preText">Almost there… 💫 (click the emojis)</div>
    <!-- sparkles will be injected here -->
  </div>
  <div id="overlay">
    <div id="loadingText"></div>
  </div>
  <div id="giftBox">
    ✨ HERE IS THE LINKKK 👉 <a id="finalLink" href="https://gaurishgotnorizz.github.io/birthday-gift/" target="_blank" rel="noopener">CLICK THISSS 💅✨</a> ✨
  </div>
  <img id="photoA" class="photo" src="pic1.jpg" alt="photoA">
  <img id="photoB" class="photo" src="pic2.jpg" alt="photoB">

  <div id="jumpscare">
    <img src="jumpscare.jpg" alt="">
  </div>

  <script>
    const CLICK_DODGE_LIMIT = 45;
    const REQUIRED_NAME_COUNT = 30;
    const TARGET_NAME = "shagun";
    const TYPEWRITER_TOTAL_SECONDS = 35;

    const clickBtn = document.getElementById('clickMe');
    const nameSection = document.getElementById('nameSection');
    const nameField = document.getElementById('nameField');
    const submitName = document.getElementById('submitName');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const overlay = document.getElementById('overlay');
    const loadingText = document.getElementById('loadingText');
    const giftBox = document.getElementById('giftBox');
    const photoA = document.getElementById('photoA');
    const photoB = document.getElementById('photoB');
    const preOverlay = document.getElementById('preOverlay');
    const preText = document.getElementById('preText');
    const jumpscare = document.getElementById('jumpscare');

    let dodgeCount = 0;
    let nameCount = 0;

    clickBtn.addEventListener('mouseover', () => {
      if (dodgeCount < CLICK_DODGE_LIMIT) {
        const x = Math.random() * (window.innerWidth - 160);
        const y = Math.random() * (window.innerHeight - 140);
        clickBtn.style.left = x + 'px';
        clickBtn.style.top = y + 'px';
        dodgeCount++;
      }
    });

    clickBtn.addEventListener('click', () => {
      if (dodgeCount >= CLICK_DODGE_LIMIT) {
        clickBtn.style.display = 'none';
        nameSection.style.display = 'block';
        setTimeout(()=> nameField.focus(), 50);
      } else {
        dodgeCount = Math.min(CLICK_DODGE_LIMIT, dodgeCount + 1);
      }
    });

    function spawnEmojiBurst(amount=8){
      const emojis = ["🤭","💅","✨","🎀","😋","💓","😝"];
      for(let i=0;i<amount;i++){
        const e = document.createElement('div');
        e.className = 'emoji';
        e.innerText = emojis[Math.floor(Math.random()*emojis.length)];
        e.style.left = (Math.random()*100) + 'vw';
        e.style.top = (-10 - Math.random()*10) + 'vh';
        e.style.fontSize = (16 + Math.random()*28) + 'px';
        document.body.appendChild(e);
        const dur = 2200 + Math.random()*1600;
        e.animate([{ transform: `translateY(0vh)`, opacity: 1 }, { transform: `translateY(110vh)`, opacity: 0 }], { duration: dur, easing: 'linear' });
        setTimeout(()=> e.remove(), dur + 60);
      }
    }

    submitName.addEventListener('click', handleNameSubmit);
    nameField.addEventListener('keydown', (ev) => {
      if(ev.key === 'Enter') handleNameSubmit();
    });

    function handleNameSubmit(){
      const val = (nameField.value || '').trim().toLowerCase();
      if(val === TARGET_NAME.toLowerCase()){
        nameCount++;
        updateProgress();
        spawnEmojiBurst(9);
        nameField.value = '';
        if(nameCount >= REQUIRED_NAME_COUNT){
          // rainbow flash
          document.body.classList.add('rainbowFlash');
          setTimeout(()=>document.body.classList.remove('rainbowFlash'), 1200);

          nameSection.style.display = 'none';
          runPreOverlayThenTypewriter();
        } else {
          setTimeout(()=> nameField.focus(), 60);
        }
      } else {
        alert('Nope 😝 Try again!');
        nameField.value = '';
        setTimeout(()=> nameField.focus(), 80);
      }
    }

    function updateProgress(){
      const pct = Math.min(100, Math.round((nameCount / REQUIRED_NAME_COUNT) * 100));
      progressBar.style.width = pct + '%';
      progressText.textContent = `${nameCount} / ${REQUIRED_NAME_COUNT}`;
    }

    /* ---------- PRE-OVERLAY: spawn clickable sparkle emojis (must click all) ---------- */
    async function runPreOverlayThenTypewriter(){
      preOverlay.style.display = 'flex';
      preText.textContent = `Almost there… 💫 (click all the emojis: 30 left)`;

      const NUM_SPARKLES = 30;
      const sparkleEmojis = ["✨","🎀","💓","💅","🤭"];
      const states = []; // {el,x,y,dx,dy,w,h}
      let clicked = 0;

      // ensure layout measured
      const parentRect = preOverlay.getBoundingClientRect();

      // create sparkles
      for(let i=0;i<NUM_SPARKLES;i++){
        const s = document.createElement('div');
        s.className = 'sparkleBtn';
        s.innerText = sparkleEmojis[Math.floor(Math.random()*sparkleEmojis.length)];
        // random initial position inside preOverlay
        const w = 28; const h = 28;
        const x = Math.random() * (parentRect.width - w);
        const y = Math.random() * (parentRect.height - h);
        s.style.left = x + 'px';
        s.style.top = y + 'px';
        // slight scale/rotate for variety
        s.style.transform = `translate(-50%,-50%) scale(${0.9 + Math.random()*0.4}) rotate(${(Math.random()*40-20)}deg)`;
        preOverlay.appendChild(s);

        // random velocity
        const dx = (Math.random()*2-1) * (0.3 + Math.random()*1.2);
        const dy = (Math.random()*2-1) * (0.3 + Math.random()*1.2);
        states.push({el:s, x, y, dx, dy, w, h});

        // click handler
        s.addEventListener('click', () => {
          // small pop effect then remove
          s.animate([{ transform: s.style.transform }, { transform: 'scale(1.6) rotate(0deg)', opacity: 0 }], { duration: 180, easing: 'ease-out' });
          setTimeout(()=> {
            if(s.parentNode) s.parentNode.removeChild(s);
          }, 190);
          clicked++;
          const left = Math.max(0, NUM_SPARKLES - clicked);
          preText.textContent = `Almost there… 💫 (click all the emojis: ${left} left)`;
          // mark removed by setting el=null (we'll filter in animation loop)
          const st = states.find(st=>st.el===s);
          if(st) st.removed = true;
          if(clicked >= NUM_SPARKLES){
            // stop animation and proceed
            // small delay to allow last pop to disappear visually
            setTimeout(() => {
              // clean up any remaining elements
              states.forEach(sobj => { if(sobj.el && sobj.el.parentNode) sobj.el.parentNode.removeChild(sobj.el); });
              // hide pre overlay and continue
              preOverlay.style.display = 'none';
              runFullOverlayThenReveal();
            }, 250);
          }
        }, { once: true });
      }

      // animation loop for sparkles
      let running = true;
      function animate(){
        if(!running) return;
        const rect = preOverlay.getBoundingClientRect();
        for(let i = states.length-1; i>=0; i--){
          const st = states[i];
          if(st.removed) { states.splice(i,1); continue; }
          // update
          st.x += st.dx;
          st.y += st.dy;
          // bounce inside preOverlay bounds
          if(st.x < 10){ st.x = 10; st.dx = Math.abs(st.dx); }
          if(st.y < 10){ st.y = 10; st.dy = Math.abs(st.dy); }
          if(st.x > rect.width - 10){ st.x = rect.width - 10; st.dx = -Math.abs(st.dx); }
          if(st.y > rect.height - 10){ st.y = rect.height - 10; st.dy = -Math.abs(st.dy); }
          if(st.el){
            st.el.style.left = st.x + 'px';
            st.el.style.top = st.y + 'px';
          }
        }
        requestAnimationFrame(animate);
      }
      animate();
      // function returns (we will continue when clicks finish)
    }

    async function runFullOverlayThenReveal(){
    overlay.style.display = 'flex';
    loadingText.textContent = '';

    const message = "Unlocking your surprise… please wait while I make it extra special 🎀💅✨😋💓";
    await typeWriter(message, TYPEWRITER_TOTAL_SECONDS * 1000);

    overlay.style.display='none';

    // Jumpscare AFTER full 35s
    jumpscare.style.display = 'flex';
    setTimeout(()=> jumpscare.style.display='none', 1200);

    revealFinal();
  }

  // typewriter that stretches typing across duration
  function typeWriter(text, duration){
    return new Promise(resolve=>{
      let i = 0;
      const interval = duration / text.length;
      const typer = setInterval(()=>{
        loadingText.textContent = text.slice(0, i+1);
        i++;
        if(i >= text.length){
          clearInterval(typer);
          resolve();
        }
      }, interval);
    });
  }

    function revealFinal(){
      giftBox.style.display = 'block';
      placePhotoRandom(photoA);
      placePhotoRandom(photoB);
      photoA.style.display = 'block';
      photoB.style.display = 'block';
      spawnEmojiBurst(20);
      confettiBlast();
      // sparkle burst (extra) on reveal
      spawnEmojiBurst(30);
    }

    function placePhotoRandom(imgEl){
      const margin = 40;
      const w = Math.min(180, window.innerWidth * 0.22);
      const h = Math.min(180, window.innerHeight * 0.22);
      const x = Math.random() * (window.innerWidth - w - margin) + margin;
      const y = Math.random() * (window.innerHeight - h - margin) + margin;
      imgEl.style.width = w + 'px';
      imgEl.style.height = h + 'px';
      imgEl.style.left = x + 'px';
      imgEl.style.top = y + 'px';
      imgEl.style.transform = `rotate(${(Math.random()*24 - 12)}deg)`;
    }

    function confettiBlast(){
      const colors = ["#ff69b4","#ff3fa1","#ffd3ec","#fff"];
      for(let i=0;i<150;i++){
        const c = document.createElement('div');
        c.style.position='fixed';
        c.style.width='8px'; c.style.height='14px';
        c.style.background=colors[Math.floor(Math.random()*colors.length)];
        c.style.left=(Math.random()*100)+'vw';
        c.style.top='-20px';
        c.style.opacity=0.9;
        document.body.appendChild(c);
        const fall = (Math.random()*3000)+2000;
        const horiz = (Math.random()*100)-50;
        c.animate([
          { transform:`translate(0,0) rotate(0deg)`},
          { transform:`translate(${horiz}px, 110vh) rotate(${360*Math.random()}deg)` }
        ], { duration: fall, easing:'ease-out' });
        setTimeout(()=>c.remove(), fall+500);
      }
    }

    progressText.textContent = `0 / ${REQUIRED_NAME_COUNT}`;
    document.addEventListener('visibilitychange', ()=> {
      if(nameSection.style.display !== 'none') nameField.focus();
    });
  </script>
</body>
</html>
